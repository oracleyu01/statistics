# 예제57: 가설검정7 - 비모수적 가설 검정
## - 정규분포를 따르지 않는 경우

### 📊 가설검정의 유형
![가설검정의 유형](그림11.png)
![가설검정의 유형](table1.png)

## 1️⃣ 비모수 검정 개요

### 비모수 검정이란?
- 모집단의 분포에 대한 가정이 필요 없는 검정 방법
- 순위(rank)나 부호(sign)를 이용
- 정규성 가정이 충족되지 않을 때 사용
- 데이터가 서열척도인 경우 사용

### 주요 비모수 검정 방법
| 모수적 방법 | 비모수적 방법 | 용도 |
|------------|--------------|------|
| 일표본 t검정 | 부호검정, 윌콕슨 부호순위검정 | 한 집단의 중앙값 검정 |
| 독립표본 t검정 | 만-휘트니 U검정(윌콕슨 순위합) | 두 독립집단의 비교 |
| 대응표본 t검정 | 윌콕슨 부호순위검정 | 대응표본의 비교 |
| 일원분산분석 | 크루스칼-왈리스 검정 | 세 개 이상 독립집단의 비교 |

## 2️⃣ 주요 비모수 검정 예제

### 📌 예제 1: 윌콕슨 부호순위검정  

고혈압 치료제의 효과를 확인하기 위해 10명의 환자를 대상으로 복용 전후의 혈압을 측정하였다.  
각 환자의 치료 전과 치료 후 혈압 차이가 유의미한지 확인하고자 한다.  
이 문제에서는 복용 전후의 혈압 차이가 통계적으로 유의미한 차이가 있는지 검정하는 것을 목표로 한다.

#### **문제 설명**  
고혈압 치료제의 효과를 평가하기 위해, 10명의 환자에게 치료 전과 후의 혈압을 측정하였다.  
치료 전 혈압과 치료 후 혈압의 차이를 비교하여, 치료가 혈압에 유의미한 영향을 미쳤는지 확인하려고 한다.

#### **분석하고자 하는 가설**
- **귀무가설 (H₀)**: "혈압 복용 전과 후 차이는 없다." (치료가 혈압에 영향을 미치지 않는다.)
- **대립가설 (H₁)**: "혈압 복용 전과 후 차이가 있다." (치료가 혈압에 영향을 미친다.)

#### **데이터**
- **before**: 치료 전의 혈압 (단위: mmHg)
- **after**: 치료 후의 혈압 (단위: mmHg)

#### **검정 방법**
1. **정규성 검정**: 치료 전후의 혈압 차이가 정규분포를 따르는지 확인
2. **쌍체 검정 (대응표본 t-검정)**: 치료 전후 혈압 차이를 비교하여, 혈압의 변화가 통계적으로 유의미한지 검정



```r
# 데이터 
before <- c(150, 145, 160, 155, 148, 152, 158, 142, 300, 310)  # 극단값 추가
after <- c(142, 140, 155, 150, 145, 148, 152, 140, 100, 90)   # 극단값 추가


```

### 📌 예제 2: 만-휘트니 U검정  

두 가지 다른 교육 방법으로 학습한 학생들의 성취도를 비교한다.   

### 윌콕슨 부호순위검정(Wilcoxon Signed-Rank Test) vs 만-휘트니 U검정(Mann-Whitney U Test)

두 검정은 **비모수 검정(non-parametric test)**으로, 데이터가 정규성을 따르지 않을 때 사용할 수 있습니다. 하지만 적용되는 데이터 유형과 가정이 다릅니다.

---

### 1. 윌콕슨 부호순위검정 (Wilcoxon Signed-Rank Test)

### ✅ 개념
- **두 개의 관련된(쌍을 이루는) 데이터** 집단에서 차이가 있는지 검정합니다.
- 대응표본 t-검정(Paired t-test)의 비모수 대안입니다.
- 차이값(두 집단의 차이)을 순위화한 후, 부호(+, -)를 고려하여 분석합니다.

### ✅ 사용 조건
- **대응표본(쌍을 이룬 데이터, paired samples)**: 같은 사람(또는 개체)에서 측정한 전후 비교 데이터가 있을 때 사용합니다.
- 정규성을 가정하지 않지만, 차이값이 대략 대칭성을 가지면 좋습니다.

### ✅ 예시
- 치료 전후의 혈압 비교
- 학생들의 시험 전후 점수 변화
- 같은 환자의 약물 복용 전후 체중 변화

### ✅ R 코드 예시
```r
wilcox.test(before, after, paired=TRUE)
```

---

### 2. 만-휘트니 U검정 (Mann-Whitney U Test)

### ✅ 개념
- **독립된 두 개의 그룹 간 차이**를 검정합니다.
- 독립표본 t-검정(Independent t-test)의 비모수 대안입니다.
- 두 그룹의 데이터가 동일한 분포를 따르는지 비교하며, 중위수 차이를 분석합니다.

### ✅ 사용 조건
- **독립표본(Independent samples)**: 두 그룹이 서로 다른 개체일 때 사용합니다.
- 정규성을 가정하지 않으며, 그룹의 크기가 달라도 됩니다.

### ✅ 예시
- 남성과 여성의 키 비교
- 두 개의 다른 치료 그룹의 효과 비교
- 두 회사 직원들의 연봉 비교

### ✅ R 코드 예시
```r
wilcox.test(group1, group2, paired=FALSE)
```
> `paired=FALSE` 옵션을 사용하여 두 그룹이 독립적임을 명시합니다.

---

### 📌 차이점 요약

|  | **윌콕슨 부호순위검정 (Wilcoxon Signed-Rank Test)** | **만-휘트니 U검정 (Mann-Whitney U Test)** |
|---|--------------------------------------|--------------------------------|
| **데이터 유형** | 같은 대상에서 측정한 **쌍(pair) 데이터** | 서로 독립적인 두 개의 그룹 |
| **비모수 대안** | 대응표본 t-검정 (Paired t-test) | 독립표본 t-검정 (Independent t-test) |
| **예시** | 치료 전후 혈압 변화, 시험 전후 점수 비교 | 남녀 평균 키 비교, A/B 테스트 결과 비교 |
| **순위화 방식** | 차이값을 순위화하고 부호 고려 | 개별 데이터의 순위를 비교 |
| **R 코드** | `wilcox.test(before, after, paired=TRUE)` | `wilcox.test(group1, group2, paired=FALSE)` |

---

### 🎯 언제 어떤 검정을 사용해야 할까?

- **같은 개체의 전후 비교** → **윌콕슨 부호순위검정**
- **서로 독립적인 두 집단 비교** → **만-휘트니 U검정**

👉 **예제 상황에서 사용한 `wilcox.test(before, after, paired=TRUE)`는 치료 전후 같은 대상의 혈압을 비교하는 것이므로 윌콕슨 부호순위검정이 적절합니다.**


#### **문제 설명**  
두 가지 교육 방법(method_A, method_B)을 사용하여 학습한 학생들의 성취도를 비교하고자 한다.  
각 교육 방법을 따른 학생들의 성적을 비교하여 두 방법 간에 성취도에 유의미한 차이가 있는지 검정하려고 한다.

#### **분석하고자 하는 가설**
- **귀무가설 (H₀)**: "두 교육 방법의 성취도 차이는 없다." (교육 방법 간 성취도 차이가 없다.)
- **대립가설 (H₁)**: "두 교육 방법의 성취도 차이가 있다." (교육 방법 간 성취도에 차이가 있다.)

#### **데이터**
- **method_A**: 교육 방법 A를 따른 학생들의 성취도
- **method_B**: 교육 방법 B를 따른 학생들의 성취도

#### **검정 방법**
1. **만-훼트니 U검정**: 두 교육 방법 간 성취도의 차이가 유의미한지 확인

#### **코드 예시**
```r
# 데이터
method_A <- c(85, 78, 82, 88, 94, 75, 85, 82)
method_B <- c(75, 72, 68, 80, 76, 70, 74, 78)





```

### 📌 예제 3: 크루스칼-왈리스 검정  

세 가지 다른 운동 프로그램의 효과를 비교한다.

#### **문제 설명**  
세 가지 운동 프로그램(program_A, program_B, program_C)을 사용하여 운동 효과를 비교하고자 한다. 각 운동 프로그램을 따른 학생들의 성취도를 비교하여, 세 프로그램 간에 유의미한 차이가 있는지 검정하려고 한다.

#### **분석하고자 하는 가설**
- **귀무가설 (H₀)**: "세 운동 프로그램 간에 성취도 차이는 없다." (운동 프로그램 간 성취도 차이가 없다.)
- **대립가설 (H₁)**: "세 운동 프로그램 간에 성취도 차이가 있다." (운동 프로그램 간 성취도에 차이가 있다.)

#### **데이터**
- **program_A**: 운동 프로그램 A를 따른 학생들의 성취도
- **program_B**: 운동 프로그램 B를 따른 학생들의 성취도
- **program_C**: 운동 프로그램 C를 따른 학생들의 성취도

#### **검정 방법**
1. **크루스칼-왈리스 검정**: 세 운동 프로그램 간 성취도의 차이가 유의미한지 확인

#### **코드 예시**
```r
# 데이터 준비
program_A <- c(5.2, 4.8, 5.5, 4.9, 5.1)
program_B <- c(4.8, 4.5, 5.9, 4.6, 4.7)
program_C <- c(5.5, 5.8, 5.6, 5.7, 5.9)




```

## 3️⃣ 연습문제

<details>
<summary><b>🎯 문제 1: 윌콕슨 부호순위검정</b></summary>

새로운 수면제의 효과를 검증하기 위해 8명의 불면증 환자를 대상으로 복용 전후의 수면 시간(시간)을 측정했다.
유의수준 5%에서 수면제가 효과가 있는지 검정하시오.

```
복용 전: 5.2, 4.8, 5.0, 4.5, 4.9, 5.1, 4.7, 4.6
복용 후: 6.1, 5.9, 5.8, 5.5, 6.0, 5.7, 5.6, 5.8
```
</details>

<details>
<summary><b>✍️ 문제 1 정답</b></summary>

```r
# 데이터 입력
before <- c(5.2, 4.8, 5.0, 4.5, 4.9, 5.1, 4.7, 4.6)
after <- c(6.1, 5.9, 5.8, 5.5, 6.0, 5.7, 5.6, 5.8)


```
</details>

<details>
<summary><b>🎯 문제 2: 만-휘트니 U검정</b></summary>

두 약국에서 판매하는 동일한 약품의 가격을 비교하고자 한다. 
각 약국에서 10개의 약품 가격을 조사했다. 
유의수준 5%에서 두 약국의 가격에 차이가 있는지 검정하시오.

```
약국 A: 5200, 4800, 5500, 4900, 5100, 5300, 4700, 5000, 5400, 4900
약국 B: 4800, 4500, 4900, 4600, 4700, 4800, 4400, 4700, 4900, 4600
```
</details>

<details>
<summary><b>✍️ 문제 2 정답</b></summary>

```r
# 데이터 입력
pharmacy_A <- c(5200, 4800, 5500, 4900, 5100, 5300, 4700, 5000, 5400, 4900)
pharmacy_B <- c(4800, 4500, 4900, 4600, 4700, 4800, 4400, 4700, 4900, 4600)


```
</details>

> 💡 **핵심 포인트**
> - 정규성 가정이 충족되지 않을 때 비모수 검정을 사용합니다
> - 비모수 검정은 데이터의 순위를 사용합니다
> - 표본 크기가 작을 때 특히 유용합니다
> - R에서는 wilcox.test(), kruskal.test() 등의 함수를 사용합니다
> - 검정 전에 항상 데이터의 특성을 확인해야 합니다
