#답:

# 저장한 데이터 불러오기
loaded_data <- read.csv("customers02.csv", fileEncoding = "utf-8")

# 데이터 확인
head(loaded_data)

# 2. 상관관계 분석
# 숫자형 변수만 선택
numeric_data <- loaded_data %>% select(purchase_amount, age, income, 
                                       region_numeric, gender_numeric)

# 상관행렬 계산
cor_matrix <- cor(numeric_data)

# 상관행렬 출력
print("상관행렬:")
print(cor_matrix)

# 상관계수 시각화 (pairs.panels)
pairs.panels(numeric_data, main = "상관행렬 및 산점도", ellipses = TRUE)

# 3. 결과 해석
# 1) 상관행렬 분석 결과:
# - 구매 금액은 소득과 강한 양의 상관관계를 가짐.
# - 나이와도 양의 상관관계를 보이지만, 소득보다는 약함.
# - 지역 인코딩 값과 약한 상관관계를 보임 (도시 > 교외 > 농촌 순으로 구매 금액이 높음).
# - 성별 인코딩 값과 구매 금액은 큰 상관관계를 보이지 않음.
#
# 2) 범주형 변수 분석 결과:
# - 지역별로 도시가 구매 금액이 가장 높음.
# - 성별은 구매 금액에 큰 영향을 미치지 않음.
